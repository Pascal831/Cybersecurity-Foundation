# ğŸ§  SIEM with Splunk â€“ Investigating SSH Failures

## ğŸ” What is Splunk?

**Splunk** is a powerful platform that enables organizations to **analyze, search, and visualize machine data**. It plays a critical role in modern **Security Information and Event Management (SIEM)** by allowing security teams to:

- Detect threats in real time  
- Investigate anomalies across systems  
- Restore services quickly  
- Automate alerting and reporting

---

## ğŸ“˜ Overview

A SIEM like Splunk is essential for **log aggregation, correlation, and analysis** across distributed sources. Its search language, **SPL (Search Processing Language)**, uses **pipes (`|`)**, **wildcards**, and other operators to drill down into specific events.

---

## ğŸ¯ Scenario

Youâ€™re a security analyst at an e-commerce company called **Buttercup Games**. You're investigating potential **unauthorized SSH login attempts** on the **mail server (`mailsv`)**.

### ğŸ§¾ Dataset Overview

The logs come from multiple hosts, including:

- `mailsv` â€“ Buttercupâ€™s mail server  
- `www1`, `www2`, `www3` â€“ Web application servers  
- `vendor_sales` â€“ Sales system

---

## âœ… Objectives

- Upload log data to Splunk  
- Search and analyze events across different hosts  
- Identify failed `root` SSH login attempts  
- Interpret key metadata fields like `host`, `source`, and `sourcetype`

---

## ğŸ› ï¸ Step-by-Step Instructions

### 1. Log in to Splunk

Create or access your Splunk instance and go to the dashboard.

---

### 2. Upload Log Data

- Go to **"Add Data"**  
- Upload the provided `tutorialdata.zip` log file  
ğŸ”— [Sample Log File](https://drive.google.com/file/d/1nDz_DZB4ADbD4tvaDa54_l1FoT_jtVy4/view)

ğŸ“¸  
![Upload Log File](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk1.png)

---

### 3. Search All Events

Navigate to **Search & Reporting**, and type:
```spl
index=main
```
Set **Time Range** to **"All time"** to view all events.

ğŸ“¸  
![Search All Time](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk2.png)

---

### 4. Understand Core Metadata

| Field       | Description                                                  |
|-------------|--------------------------------------------------------------|
| `host`      | System where the log event originated                        |
| `source`    | The path or stream that delivered the event data             |
| `sourcetype`| Format of the event (e.g., syslog, access_combined)         |

ğŸ“¸  
**Host Example**  
![Host](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk3.png)

**Source Example**  
![Source](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk4.png)

**Sourcetype Example**  
![Sourcetype](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk5.png)

---

### 5. Focus on the Mail Server

Search:
```spl
index=main host=mailsv
```

This limits the query to events generated by the mail server `mailsv`.

ğŸ“¸  
![Mail Server Search](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk6.png)

---

### 6. Detect Failed SSH Logins

Search for failed root login attempts:
```spl
index=main host=mailsv fail* root
```

- `fail*` uses a **wildcard** to match `failed`, `failure`, etc.  
- `root` identifies attempts involving the root user.

ğŸ“¸  
![Failed SSH Root](https://github.com/Pascal831/Cybersecurity-Foundation/blob/main/Screenshots/Splunk7.png)

---

## ğŸ” Investigation Findings

- The **main index** contains over **100,000 events**
- The **mail server (`mailsv`)** generated **9,000+ events**
- As of **Feb 11, 2024**, there were **346 failed SSH login attempts** for the `root` account
- The **`vendor_sales`** host logs **e-commerce transactions**

---

## ğŸ§  Conclusion

Splunkâ€™s SIEM capabilities allow analysts to:
- Rapidly detect suspicious patterns  
- Focus on specific systems like `mailsv`  
- Use SPL to extract meaningful insights from vast log datasets

Combining structured queries with flexible search operators makes **Splunk a key tool for modern threat detection and investigation**.
